<section class="cart py-16">
  <% if(session.cart?.deleted===false) { %>
  <div class="order container mx-auto w-1/2">
    <div class="flex items-center border-b border-gray-300 pb-4">
      <img src="/img/cart-black.png" alt="" />
      <h1 class="font-bold ml-4 text-2xl">Order summary</h1>
    </div>
    <div class="pizza-list">
      <form action="/emptycart" method="post">
        <button
          class="btn-danger px-6 py-2 rounded-full text-white font-bold my-6"
          type="submit"
          onClick="return confirm('Are you sure to delete?')"
        >
          Empty Cart
        </button>
      </form>
      <% for(let pizza of Object.values(session.cart.cartItems.items)) { %>
      <div class="my-8 grid grid-cols-4 gap-4 flex justify-center items-center">
        <img class="w-24" src="/img/<%= pizza.image %>" alt="" />
        <div class="flex w-50 ml-4 text-lg">
          <h1><%= pizza.name %></h1>
        </div>
        <div class="itemQuantity grid grid-cols-3 ml-4">
          <form action="/cart/minusitem" method="post">
            <input type="hidden" name="pizza" value="<%= pizza._id %>" />
            <input type="hidden" name="price" value="<%= pizza.price %>" />
            <button
              type="submit"
              class="circle-icon las la-minus-circle"
            ></button>
          </form>
          <div><%= pizza.qty %> Pcs</div>
          <form action="/cart/plusitem" method="post">
            <input type="hidden" name="pizza" value="<%= pizza._id %>" />
            <input type="hidden" name="price" value="<%= pizza.price %>" />
            <button
              type="submit"
              class="circle-icon las la-plus-circle"
            ></button>
          </form>
        </div>
        <span class="font-bold text-lg">â‚¹ <%= pizza.price * pizza.qty %></span>
      </div>
      <% } %>
      <!-- <% for(let pizza of Object.values(session.cart.cartItems.items)) { %>
      <div class="flex items-center my-8 justify-around">
        <img class="w-24" src="/img/<%= pizza.image %>" alt="" />
        <div class="flex w-50 ml-4 text-lg">
          <h1><%= pizza.name %></h1>
        </div>
        <div class="itemQuantity flex flex-row ml-4 justify-around w-50">
          <form action="/cart/minusitem" method="post">
            <input type="hidden" name="pizza" value="<%= pizza._id %>" />
            <input type="hidden" name="price" value="<%= pizza.price %>" />
            <button
              type="submit"
              class="circle-icon las la-minus-circle"
            ></button>
          </form>
          <div><%= pizza.qty %> Pcs</div>
          <form action="/cart/plusitem" method="post">
            <input type="hidden" name="pizza" value="<%= pizza._id %>" />
            <input type="hidden" name="price" value="<%= pizza.price %>" />
            <button
              type="submit"
              class="circle-icon las la-plus-circle"
            ></button>
          </form>
        </div>
        <span class="font-bold text-lg">â‚¹ <%= pizza.price * pizza.qty %></span>
      </div>
      <% } %> -->
      <hr />
      <div class="text-right py-4">
        <div>
          <span class="text-lg font-bold">Total Amount:</span>
          <span class="amount text-2xl font-bold ml-2"
            >â‚¹<%= session.cart.cartItems.totalPrice %></span
          >
        </div>
        <% if(user) { %>
        <div>
          <form action="/orders" method="post" class="mt-12">
            <% if(messages.error) { %>
            <span class="text-red-500 text-sm"><%= messages.error %></span>
            <br />
            <% } %>
            <input
              name="phone"
              value="<%= user.number %>"
              class="border border-gray-400 p-2 w-1/2 mb-4"
              type="number"
              placeholder="Phone number"
            />
            <input
              name="address"
              class="border border-gray-400 p-2 w-1/2"
              type="text"
              placeholder="Address"
            />
            <div>
              <button
                class="btn-primary px-6 py-2 rounded-full text-white font-bold mt-6"
                type="submit"
              >
                Order Now
              </button>
            </div>
          </form>
        </div>
        <% } else { %>
        <a
          href="/login"
          class="inline-block cursor-pointer btn-primary px-6 py-2 rounded-full text-white font-bold mt-6"
          >Login to continue</a
        >
        <% } %>
      </div>
    </div>
  </div>
  <% } else { %>
  <div class="empty-cart py-16">
    <div class="container mx-auto text-center">
      <h1 class="text-3xl font-bold mb-2">Cart Empty ðŸ˜•</h1>
      <p class="text-gray-500 text-lg mb-12">
        You probably haven't ordered a pizza yet. <br />
        To order a pizza, go to the main page.
      </p>
      <img class="w-2/5 mx-auto" src="/img/empty-cart.png" alt="empty-cart" />
      <a
        href="/"
        class="inline-block px-6 py-2 rounded-full btn-primary text-white font-bold mt-12"
        >Go back</a
      >
    </div>
  </div>
  <% } %>
</section>
